<%
layout("/layouts/clean.html"){
%>

    <body class="">
        <div class="center-wrapper">
            <div class="center-content">
                <div class="row no-m">
                    <div class="col-xs-10 col-xs-offset-1 col-sm-6 col-sm-offset-3 col-md-6 col-md-offset-3">
                        <section class="bg-white no-b">
                            <ul class="switcher-dash-action">
                                <li>
                                    <a href="/sysadmin" class="selected">登陆</a>
                                </li>
                                <li class="active">
                                    <a href="#" class="">注册</a>
                                </li>
                            </ul>


                            <div class="step-content">
                                <form id="addForm" role="form" class="form-horizontal parsley-form" data-parsley-validate action="${base}/public/doreg" method="post">

                                    <!--账号注册-->
                                    <!-- <div class="form-group">
                                <label for="loginname" class="col-sm-3 control-label">用户名</label>
                                <div class="col-sm-8">
                                    <input type="text" id="loginname" class="form-control" name="user.loginname" data-parsley-trigger="change"
                                           data-parsley-required="true" data-parsley-maxlength="6"  placeholder="">
                                </div>
                            </div> -->

                                    <!-- todo: remote ajax认证！ -->
                                    <div class="form-group">
                                        <label for="email" class="col-sm-3 control-label">邮箱</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="email" name="gyinf.email" data-parsley-type="email" class="form-control" placeholder="请输入您的邮箱!" data-parsley-trigger="change">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="password" class="col-sm-3 control-label">登陆密码</label>
                                        <div class="col-sm-8">
                                            <input type="password" id="password" class="form-control" name="user.password" data-parsley-required="true" placeholder="请输入8-16位密码"
                                                data-parsley-maxlength="16" data-parsley-minlength="8" data-parsley-trigger="change">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="username" class="col-sm-3 control-label">用户名</label>

                                        <div class="col-sm-8">
                                            <input type="text" id="username" class="form-control" name="user.username" data-parsley-required="true" placeholder="用户名">
                                        </div>
                                    </div>

                                    <!--基本信息-->
                                    <div class="form-group">
                                        <label for="realname" class="col-sm-3 control-label">真实姓名</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="realname" class="form-control" name="gyinf.realname" data-parsley-required="true" placeholder="请输入您的真实姓名！"  data-parsley-pattern="/^[\u4E00-\u9FA5A-Za-z]+$/"  data-parsley-trigger="change">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="sex" class="col-sm-3 control-label">性别</label>
                                        <div class="col-sm-8">
                                            <select id="sex" name="gyinf.sex" data-parsley-required="true" class="form-control">
                                                <option value="0">男</option>
                                                <option value="1">女</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="qq" class="col-sm-3 control-label">qq</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="qq" class="form-control" name="gyinf.qq" data-parsley-required="true" placeholder="请填写您的qq，方便我们联系。" data-parsley-pattern="[1-9][0-9]{4,14}" data-parsley-trigger="change">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="phone" class="col-sm-3 control-label">${msg['gy.inf.column.phone']}</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="phone" class="form-control" name="gyinf.phone" data-parsley-required="true" placeholder="请输入您本人的手机号！" data-parsley-trigger="change">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="idcard" class="col-sm-3 control-label">${msg['gy.inf.column.idcard']}</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="idcard" class="form-control" name="gyinf.idcard" data-parsley-required="true" placeholder="请输入您本人的身份证号！" data-parsley-trigger="change">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="birthday" class="col-sm-3 control-label">${msg['gy.inf.column.birthday']}</label>
                                        <div class="col-sm-8 input-group date form_datetime" style="padding-left: 16px;padding-right: 16px;" data-date="1979-09-16T05:25:07Z"
                                            data-date-format="dd MM yyyy - HH:ii p" data-link-field="birthday">
                                            <input type="text" size="16" readonly class="form-control" value="${@date.getDate()}" data-parsley-required="true">
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-remove"></span>
                                            </span>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-th"></span>
                                            </span>
                                        </div>
                                        <input type="hidden" id="birthday" name="birthdayat" value="${@date.getDate()}" />
                                    </div>

                                    <div class="form-group">
                                        <label for="college" class="col-sm-3 control-label">${msg['gy.inf.column.college']}</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="college" class="form-control" name="gyinf.college" data-parsley-required="true" placeholder="${msg['gy.inf.column.college']}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="school" class="col-sm-3 control-label">${msg['gy.inf.column.school']}</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="school" class="form-control" name="gyinf.school" data-parsley-required="true" placeholder="${msg['gy.inf.column.school']}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="major" class="col-sm-3 control-label">${msg['gy.inf.column.major']}</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="major" class="form-control" name="gyinf.major" data-parsley-required="true" placeholder="${msg['gy.inf.column.major']}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="stuLevel" class="col-sm-3 control-label">${msg['gy.inf.column.stuLevel']}</label>
                                        <div class="col-sm-8">
                                            <select id="stuLevel" name="gyinf.stuLevel" data-parsley-required="true" class="form-control">
                                                <option value="0">本科在读</option>
                                                <option value="1">研究生在读</option>
                                                <option value="2">博士在读</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="regYear" class="col-sm-3 control-label">${msg['gy.inf.column.regYear']}</label>
                                        <div class="col-sm-8 input-group date form_datetime" style="padding-left: 16px;padding-right: 16px;" data-date-format="dd MM yyyy"
                                            data-link-field="regYear">
                                            <input type="text" size="16" readonly class="form-control" value="${@date.getDate()}" data-parsley-required="true">
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-remove"></span>
                                            </span>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-th"></span>
                                            </span>
                                        </div>
                                        <input type="hidden" id="regYear" name="regYearat" value="${@date.getDate()}" />
                                    </div>


                                    <!--证件上传-->
                                    <div class="form-group">
                                        <label for="idcardF" class="col-sm-3 control-label">${msg['gy.auth.column.idcardF']}</label>
                                        <div class="col-sm-8">
                                            <div id="idcardFqueue"></div>
                                            <div>
                                                <input id="idcardF_upload" name="file_upload" type="file" multiple="false">
                                            </div>
                                            <div id="idcardFimg" style="padding: 5px;">
                                            </div>
                                            <input type="hidden" id="idcardF" name="gyauth.idcardF" value="">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="idcardB" class="col-sm-3 control-label">${msg['gy.auth.column.idcardB']}</label>
                                        <div class="col-sm-8">
                                            <div id="idcardBqueue"></div>
                                            <div>
                                                <input id="idcardB_upload" name="file_upload" type="file" multiple="false">
                                            </div>
                                            <div id="idcardBimg" style="padding: 5px;">
                                            </div>
                                            <input type="hidden" id="idcardB" name="gyauth.idcardB" value="">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="stuCardF" class="col-sm-3 control-label">${msg['gy.auth.column.stuCardF']}</label>
                                        <div class="col-sm-8">
                                            <div id="stuCardFqueue"></div>
                                            <div>
                                                <input id="stuCardF_upload" name="file_upload" type="file" multiple="false">
                                            </div>
                                            <div id="stuCardFimg" style="padding: 5px;">
                                            </div>
                                            <input type="hidden" id="stuCardF" name="gyauth.stuCardF" value="">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="stuCardB" class="col-sm-3 control-label">${msg['gy.auth.column.stuCardB']}</label>
                                        <div class="col-sm-8">
                                            <div id="stuCardBqueue"></div>
                                            <div>
                                                <input id="stuCardB_upload" name="file_upload" type="file" multiple="false">
                                            </div>
                                            <div id="stuCardBimg" style="padding: 5px;">
                                            </div>
                                            <input type="hidden" id="stuCardB" name="gyauth.stuCardB" value="">
                                        </div>
                                    </div>


                                    <div class="form-group text-center">
                                        <div class="col-lg-3"></div>
                                        <div class="col-lg-6">
                                            <label></label>
                                            <button class="btn btn-primary btn-block btn-lg btn-parsley" data-loading-text="正在提交...">提 交
                                            </button>
                                        </div>
                                    </div>
                                </form>

                                <p class="text-center">
                                    Copyright &copy;
                                    <span id="year" class="mr5"></span>
                                    <span>武汉哎嘀信息科技有限公司</span>
                                </p>
                            </div>
                        </section>
                    </div>

                </div>

            </div>
        </div>
        <script type="text/javascript">
            var el = document.getElementById("year"),
                year = (new Date().getFullYear());
            el.innerHTML = year;
            var ue;
            $(document).ready(function () {
                myForm.init();


                //        时间选择
                $('.form_datetime').datetimepicker({
                    language: 'zh-CN',
                    format: 'yyyy-mm-dd',
                    weekStart: 1,
                    todayBtn: 1,
                    autoclose: 1,
                    todayHighlight: 1,
                    startView: 2,
                    forceParse: 0,
                    showMeridian: 1
                });

                //        上传文件
                $('#idcardF_upload').uploadifive({
                    'auto': true,
                    'multi': false,
                    'width': '100%',
                    'height': '35',
                    'buttonText': '请选择图片',
                    'fileType': 'image/jpg,image/jpeg,image/png',
                    'fileSizeLimit': 1024,
                    'queueSizeLimit': 1,
                    'formData': {},
                    'queueID': 'idcardFqueue',
                    'uploadScript': '${base}/open/file/upload/gyauimage',
                    'onUploadComplete': function (file, data) {
                        data = JSON.parse(data);
                        if (data.code == 0) {
                            Toast.success(data.msg);
                            $("#idcardFimg").html("<img src='" + data.data + "' style='width:150px;height:95px;'>");
                            $("#idcardF").val(data.data);
                        } else {
                            clearFile("idcardF");
                            Toast.error(data.msg);
                        }
                    },
                    'onDrop': function (file, fileDropCount) {
                        clearFile("idcardF");
                    },
                    'onClearQueue': function (queue) {
                        clearFile("idcardF");
                    },
                    'onCancel': function () {
                        clearFile("idcardF");
                    }
                });

                $('#idcardB_upload').uploadifive({
                    'auto': true,
                    'multi': false,
                    'width': '100%',
                    'height': '35',
                    'buttonText': '请选择图片',
                    'fileType': 'image/jpg,image/jpeg,image/png',
                    'fileSizeLimit': 1024,
                    'queueSizeLimit': 1,
                    'formData': {},
                    'queueID': 'idcardBqueue',
                    'uploadScript': '${base}/open/file/upload/gyauimage',
                    'onUploadComplete': function (file, data) {
                        data = JSON.parse(data);
                        if (data.code == 0) {
                            Toast.success(data.msg);
                            $("#idcardBimg").html("<img src='" + data.data + "' style='width:150px;height:95px;'>");
                            $("#idcardB").val(data.data);
                        } else {
                            clearFile("idcardB");
                            Toast.error(data.msg);
                        }
                    },
                    'onDrop': function (file, fileDropCount) {
                        clearFile("idcardB");
                    },
                    'onClearQueue': function (queue) {
                        clearFile("idcardB");
                    },
                    'onCancel': function () {
                        clearFile("idcardB");
                    }
                });

                $('#stuCardF_upload').uploadifive({
                    'auto': true,
                    'multi': false,
                    'width': '100%',
                    'height': '35',
                    'buttonText': '请选择图片',
                    'fileType': 'image/jpg,image/jpeg,image/png',
                    'fileSizeLimit': 1024,
                    'queueSizeLimit': 1,
                    'formData': {},
                    'queueID': 'stuCardFqueue',
                    'uploadScript': '${base}/open/file/upload/gyauimage',
                    'onUploadComplete': function (file, data) {
                        data = JSON.parse(data);
                        if (data.code == 0) {
                            Toast.success(data.msg);
                            $("#stuCardFimg").html("<img src='" + data.data + "' style='width:150px;height:95px;'>");
                            $("#stuCardF").val(data.data);
                        } else {
                            clearFile("stuCardF");
                            Toast.error(data.msg);
                        }
                    },
                    'onDrop': function (file, fileDropCount) {
                        clearFile("stuCardF");
                    },
                    'onClearQueue': function (queue) {
                        clearFile("stuCardF");
                    },
                    'onCancel': function () {
                        clearFile("stuCardF");
                    }
                });

                $('#stuCardB_upload').uploadifive({
                    'auto': true,
                    'multi': false,
                    'width': '100%',
                    'height': '35',
                    'buttonText': '请选择图片',
                    'fileType': 'image/jpg,image/jpeg,image/png',
                    'fileSizeLimit': 1024,
                    'queueSizeLimit': 1,
                    'formData': {},
                    'queueID': 'stuCardBqueue',
                    'uploadScript': '${base}/open/file/upload/gyauimage',
                    'onUploadComplete': function (file, data) {
                        data = JSON.parse(data);
                        if (data.code == 0) {
                            Toast.success(data.msg);
                            $("#stuCardBimg").html("<img src='" + data.data + "' style='width:150px;height:95px;'>");
                            $("#stuCardB").val(data.data);
                        } else {
                            clearFile("stuCardB");
                            Toast.error(data.msg);
                        }
                    },
                    'onDrop': function (file, fileDropCount) {
                        clearFile("stuCardB");
                    },
                    'onClearQueue': function (queue) {
                        clearFile("stuCardB");
                    },
                    'onCancel': function () {
                        clearFile("stuCardB");
                    }
                });

                function clearFile(temp) {
                    $("#" + temp + "img").html("");
                    $("#" + temp + "queue").html("");
                    $("#" + temp + "picurl").val("");
                }

                //        提交注册信息
                $('#addForm').ajaxForm({
                    dataType: 'json',
                    beforeSubmit: function (arr, form, options) {
                        form.find("button:submit").button("loading");
                    },
                    success: function (data, statusText, xhr, form) {
                        if (data.code == 0) {
                            Toast.success(data.msg);
                            window.location.href("/sysadmin")
                            //登入系统
                        } else {
                            Toast.error(data.msg);
                        }
                        form.find("button:submit").button("reset");
                    }
                });
            });
        </script>
    </body>

    <script src="${base!}/assets/plugins/fuelux/wizard.js"></script>

    <%}%>